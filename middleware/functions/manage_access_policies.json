{
  "name": "manage_access_policies",
  "description": "Add or remove access policies for an existing key vault.",
  "strict": true,
  "parameters": {
    "type": "object",
    "properties": {
      "resource_group_name": {
        "type": "string",
        "description": "The name of the resource group containing the key vault."
      },
      "key_vault_name": {
        "type": "string",
        "description": "The name of the key vault."
      },
      "operation": {
        "type": "string",
        "enum": [
          "add",
          "remove"
        ],
        "description": "The operation to perform: 'add' to add policies, 'remove' to remove policies."
      },
      "policies": {
        "type": "array",
        "description": "List of access policies to add or remove.",
        "items": {
          "type": "object",
          "properties": {
            "object_id": {
              "type": "string",
              "description": "The unique object ID of the user, group, or application in Azure AD."
            },
            "permissions": {
              "type": "object",
              "description": "Permissions granted to the specified object ID.",
              "properties": {
                "keys": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": [
                      "get",
                      "list",
                      "create",
                      "delete",
                      "update",
                      "import",
                      "backup",
                      "restore",
                      "recover",
                      "purge"
                    ]
                  },
                  "description": "Key-related permissions."
                },
                "secrets": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": [
                      "get",
                      "list",
                      "set",
                      "delete",
                      "backup",
                      "restore",
                      "recover",
                      "purge"
                    ]
                  },
                  "description": "Secret-related permissions."
                },
                "certificates": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": [
                      "get",
                      "list",
                      "create",
                      "import",
                      "delete",
                      "backup",
                      "restore",
                      "managecontacts",
                      "manageissuers",
                      "getissuers",
                      "listissuers",
                      "setissuers",
                      "deleteissuers",
                      "recover",
                      "purge"
                    ]
                  },
                  "description": "Certificate-related permissions."
                }
              },
              "required": [
                "keys",
                "secrets",
                "certificates"
              ],
              "additionalProperties": false
            }
          },
          "required": [
            "object_id",
            "permissions"
          ],
          "additionalProperties": false
        }
      }
    },
    "required": [
      "resource_group_name",
      "key_vault_name",
      "operation",
      "policies"
    ],
    "additionalProperties": false
  }
}