{
  "name": "create_key_vault",
  "description": "Create a key vault.",
  "strict": false,
  "parameters": {
    "type": "object",
    "properties": {
      "resource_group_name": {
        "type": "string",
        "description": "The name of the resource group."
      },
      "key_vault_name": {
        "type": "string",
        "description": "The name of the key vault."
      },
      "location": {
        "type": "string",
        "description": "The location where the key vault is deployed."
      },
      "tenantId": {
        "type": "string",
        "description": "The id of the tennant for which access policies are defined."
      },
      "access_policies": {
        "type": "array",
        "description": "Access policies for the key vault.",
        "items": {
          "type": "object",
          "properties": {
            "object_id": {
              "type": "string",
              "description": "The id for which the access policy is defined."
            },
            "permissions": {
              "type": "object",
              "properties": {
                "keys": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": [
                      "get",
                      "list",
                      "create",
                      "delete",
                      "update",
                      "import",
                      "backup",
                      "restore",
                      "recover",
                      "purge"
                    ]
                  }
                },
                "secrets": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": [
                      "get",
                      "list",
                      "set",
                      "delete",
                      "backup",
                      "restore",
                      "recover",
                      "purge"
                    ]
                  }
                },
                "certificates": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": [
                      "get",
                      "list",
                      "set",
                      "delete",
                      "backup",
                      "restore",
                      "recover",
                      "purge"
                    ]
                  }
                }
              },
              "additionalProperties": false
            },
            "additionalProperties": false
          }
        },
        "additionalProperties": false
      }
    },
    "required": [
      "resource_group_name",
      "key_vault_name",
      "location"
    ]
  }
}